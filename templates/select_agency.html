<!DOCTYPE html>
<html>
<head>
    <title>Select Agency - Dataset Auto Import</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>
    <div class="container">
        <header class="concept-header">
            <div class="concept-header-content">
                <h1 class="concept-header-title">Select Agency</h1>
                <a href="{{ url_for('upload_file') }}" class="btn-back-overview">&larr; Back to Upload</a>
            </div>
        </header>
        <div class="agency-selection-content">
            <p>Your account has access to multiple agencies. Please select which one you want to use:</p>
            
            <form action="/" method="post" enctype="multipart/form-data">
                <!-- Hidden token field to carry it forward -->
                <input type="hidden" name="token" value="{{ token }}">
                
                <div class="form-group">
                    <label for="selected_agency">Agency:</label>
                    <select name="selected_agency" id="selected_agency" required>
                        <option value="">-- Select Agency --</option>
                        {% for agency in agencies %}
                        <option value="{{ agency.identifier }}">{{ agency.name.de }} ({{ agency.identifier }})</option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Copy all other fields from index.html except dataset_id and publisher_id -->
                <div class="form-group">
                    <label for="responsible_person">Responsible Person (email):</label>
                    <input type="email" name="responsible_person" id="responsible_person" required>
                </div>
                
                <div class="form-group">
                    <label for="responsible_deputy">Responsible Deputy (email):</label>
                    <input type="email" name="responsible_deputy" id="responsible_deputy" required>
                </div>
                
                <div class="form-group">
                    <label for="theme">Theme:</label>
                    <select name="theme" id="theme" required>
                        <option value="">-- Select Theme --</option>
                        {% for code, name in themes.items() %}
                        <option value="{{ code }}">{{ code }} - {{ name }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="file">Upload Excel File:</label>
                    <input type="file" name="file" id="file" accept=".xlsx,.xls,.csv" required>
                </div>
                
                <button type="submit">Upload and Analyze</button>
            </form>
        </div>
    </div>
</body>
</html>
